{% extends "layout.html" %}
{% block content %}
<div class="max-w-6xl mx-auto px-4 py-10">

  <!-- Header with Back Button and Title -->
  <div class="flex items-center gap-4 mb-6">
    <a href="{{ url_for('admin.packages') }}"
      class="inline-flex items-center rounded-lg px-4 py-2 font-medium btn-ghost bg-gray-100 text-gray-800 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-600">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      ย้อนกลับ
    </a>
    <h1 class="text-3xl font-semibold">แก้ไขแพ็กเกจ #{{ pkg.id }}</h1>
  </div>

  <!-- Edit Package Form Card -->
  <form method="post" class="bg-white rounded-2xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow p-6">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

    <div class="grid md:grid-cols-2 gap-6">

      <!-- Code Field -->
      <div>
        <label for="code" class="block text-sm font-medium text-gray-700 mb-1">Code</label>
        <input name="code" id="code" value="{{ pkg.code }}"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3"
          required>
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับใส่โค้ดแพ็กเกจ</p>
      </div>

      <!-- Name Field -->
      <div>
        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
        <input name="name" id="name" value="{{ pkg.name }}"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3"
          required>
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับใส่ชื่อแพ็กเกจ</p>
      </div>

      <!-- Price Field -->
      <div>
        <label for="price_thb" class="block text-sm font-medium text-gray-700 mb-1">Price (THB)</label>
        <input type="number" name="price_thb" id="price_thb" value="{{ pkg.price_thb or '' }}"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3">
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับใส่ราคา (บาท)</p>
      </div>

      <!-- Credits Field -->
      <div>
        <label for="credits" class="block text-sm font-medium text-gray-700 mb-1">Credits</label>
        <input type="number" name="credits" id="credits" value="{{ pkg.credits or 0 }}"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3">
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับใส่จำนวนเครดิต</p>
      </div>

      <!-- Duration Field -->
      <div>
        <label for="duration_days" class="block text-sm font-medium text-gray-700 mb-1">Duration (days)</label>
        <input type="number" name="duration_days" id="duration_days" value="{{ pkg.duration_days or '' }}"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3"
          {{ pkg.is_lifetime and 'disabled' or '' }}>
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับใส่อายุแพ็กเกจ (วัน)</p>
      </div>

      <!-- Status Select -->
      <div>
        <label for="status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
        <select name="status" id="status"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3">
          <option value="active" {{ pkg.status=='active' and 'selected' or '' }}>active</option>
          <option value="inactive" {{ pkg.status=='inactive' and 'selected' or '' }}>inactive</option>
        </select>
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับเลือกสถานะแพ็กเกจ</p>
      </div>

      <!-- Lifetime Checkbox (Info Alert Style) -->
      <div class="md:col-span-2">
        <div class="flex items-center gap-3 p-4 bg-blue-50 rounded-lg border border-blue-200">
          <input type="checkbox" name="is_lifetime" id="lifetime" {{ pkg.is_lifetime and 'checked' or '' }}
            class="rounded border-gray-300 text-blue-600 focus:ring-blue-600">
          <label for="lifetime" class="text-sm font-medium text-blue-800">Lifetime Package</label>
          <p class="text-xs text-blue-600 ml-auto">ติ๊กถ้าเป็นแพ็กเกจตลอดชีพ</p>
        </div>
      </div>

      <!-- Promotion Select -->
      <div class="md:col-span-2">
        <label for="promotion_id" class="block text-sm font-medium text-gray-700 mb-1">Promotion</label>
        <select name="promotion_id" id="promotion_id"
          class="h-10 w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 pl-3">
          <option value="">-- ไม่ผูกโปรโมชัน --</option>
          {% for pr in promos %}
          <option value="{{ pr.id }}" {{ (pkg.promotion_id==pr.id) and 'selected' or '' }}>
            {{ pr.code }} — {{ pr.name }}
          </option>
          {% endfor %}
        </select>
        <p class="text-xs text-gray-500 mt-1">กล่องนี้สำหรับเลือกโปรโมชันที่ผูกกับแพ็กเกจ</p>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex items-center justify-end gap-4 mt-8 pt-6 border-t border-gray-200">
      <a href="{{ url_for('admin.packages') }}"
        class="inline-flex items-center rounded-lg px-4 py-2 font-medium btn-ghost bg-gray-100 text-gray-800 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-600">ยกเลิก</a>
      <button type="submit"
        class="inline-flex items-center rounded-lg px-4 py-2 font-medium btn-primary bg-blue-600 text-white hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        บันทึกการเปลี่ยนแปลง
      </button>
    </div>
  </form>
</div>
{% endblock %}
